var app=function(){"use strict";function e(){}function t(e){return e()}function n(){return Object.create(null)}function r(e){e.forEach(t)}function o(e){return"function"==typeof e}function a(e,t){return e!=e?t==t:e!==t||e&&"object"==typeof e||"function"==typeof e}function i(t,n,r){t.$$.on_destroy.push(function(t,...n){if(null==t)return e;const r=t.subscribe(...n);return r.unsubscribe?()=>r.unsubscribe():r}(n,r))}function u(e,t,n,r){if(e){const o=s(e,t,n,r);return e[0](o)}}function s(e,t,n,r){return e[1]&&r?function(e,t){for(const n in t)e[n]=t[n];return e}(n.ctx.slice(),e[1](r(t))):n.ctx}function c(e,t,n,r){if(e[2]&&r){const o=e[2](r(n));if(void 0===t.dirty)return o;if("object"==typeof o){const e=[],n=Math.max(t.dirty.length,o.length);for(let r=0;r<n;r+=1)e[r]=t.dirty[r]|o[r];return e}return t.dirty|o}return t.dirty}function l(e,t,n,r,o,a){if(o){const i=s(t,n,r,a);e.p(i,o)}}function d(e){if(e.ctx.length>32){const t=[],n=e.ctx.length/32;for(let e=0;e<n;e++)t[e]=-1;return t}return-1}function f(e,t){e.appendChild(t)}function p(e,t,n){e.insertBefore(t,n||null)}function m(e){e.parentNode.removeChild(e)}function h(e,t){for(let n=0;n<e.length;n+=1)e[n]&&e[n].d(t)}function v(e){return document.createElement(e)}function y(e){return document.createTextNode(e)}function g(){return y(" ")}function A(){return y("")}function b(e,t,n,r){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n,r)}function q(e){return function(t){return t.preventDefault(),e.call(this,t)}}function w(e,t,n){null==n?e.removeAttribute(t):e.getAttribute(t)!==n&&e.setAttribute(t,n)}function S(e,t,n,r){null===n?e.style.removeProperty(t):e.style.setProperty(t,n,r?"important":"")}function x(e,t,n){e.classList[n?"add":"remove"](t)}let k;function T(e){k=e}function E(){if(!k)throw new Error("Function called outside component initialization");return k}function I(){const e=E();return(t,n)=>{const r=e.$$.callbacks[t];if(r){const o=function(e,t,n=!1){const r=document.createEvent("CustomEvent");return r.initCustomEvent(e,n,!1,t),r}(t,n);r.slice().forEach((t=>{t.call(e,o)}))}}}const M=[],C=[],$=[],_=[],B=Promise.resolve();let O=!1;function U(e){$.push(e)}const F=new Set;let K=0;function D(){const e=k;do{for(;K<M.length;){const e=M[K];K++,T(e),W(e.$$)}for(T(null),M.length=0,K=0;C.length;)C.pop()();for(let e=0;e<$.length;e+=1){const t=$[e];F.has(t)||(F.add(t),t())}$.length=0}while(M.length);for(;_.length;)_.pop()();O=!1,F.clear(),T(e)}function W(e){if(null!==e.fragment){e.update(),r(e.before_update);const t=e.dirty;e.dirty=[-1],e.fragment&&e.fragment.p(e.ctx,t),e.after_update.forEach(U)}}const N=new Set;let P;function R(){P={r:0,c:[],p:P}}function j(){P.r||r(P.c),P=P.p}function J(e,t){e&&e.i&&(N.delete(e),e.i(t))}function V(e,t,n,r){if(e&&e.o){if(N.has(e))return;N.add(e),P.c.push((()=>{N.delete(e),r&&(n&&e.d(1),r())})),e.o(t)}}function Z(e){e&&e.c()}function G(e,n,a,i){const{fragment:u,on_mount:s,on_destroy:c,after_update:l}=e.$$;u&&u.m(n,a),i||U((()=>{const n=s.map(t).filter(o);c?c.push(...n):r(n),e.$$.on_mount=[]})),l.forEach(U)}function Y(e,t){const n=e.$$;null!==n.fragment&&(r(n.on_destroy),n.fragment&&n.fragment.d(t),n.on_destroy=n.fragment=null,n.ctx=[])}function L(e,t){-1===e.$$.dirty[0]&&(M.push(e),O||(O=!0,B.then(D)),e.$$.dirty.fill(0)),e.$$.dirty[t/31|0]|=1<<t%31}function X(t,o,a,i,u,s,c,l=[-1]){const d=k;T(t);const f=t.$$={fragment:null,ctx:null,props:s,update:e,not_equal:u,bound:n(),on_mount:[],on_destroy:[],on_disconnect:[],before_update:[],after_update:[],context:new Map(o.context||(d?d.$$.context:[])),callbacks:n(),dirty:l,skip_bound:!1,root:o.target||d.$$.root};c&&c(f.root);let p=!1;if(f.ctx=a?a(t,o.props||{},((e,n,...r)=>{const o=r.length?r[0]:n;return f.ctx&&u(f.ctx[e],f.ctx[e]=o)&&(!f.skip_bound&&f.bound[e]&&f.bound[e](o),p&&L(t,e)),n})):[],f.update(),p=!0,r(f.before_update),f.fragment=!!i&&i(f.ctx),o.target){if(o.hydrate){const e=function(e){return Array.from(e.childNodes)}(o.target);f.fragment&&f.fragment.l(e),e.forEach(m)}else f.fragment&&f.fragment.c();o.intro&&J(t.$$.fragment),G(t,o.target,o.anchor,o.customElement),D()}T(d)}class Q{$destroy(){Y(this,1),this.$destroy=e}$on(e,t){const n=this.$$.callbacks[e]||(this.$$.callbacks[e]=[]);return n.push(t),()=>{const e=n.indexOf(t);-1!==e&&n.splice(e,1)}}$set(e){var t;this.$$set&&(t=e,0!==Object.keys(t).length)&&(this.$$.skip_bound=!0,this.$$set(e),this.$$.skip_bound=!1)}}function H(t){let n,o,a;return{c(){n=v("div"),S(n,"--width",t[1]-.47*t[1]*!t[5]+"px"),S(n,"transform","translate("+t[4]+"px)"),w(n,"draggable","false"),w(n,"class","svelte-cuiora"),x(n,"accidental",!t[5]),x(n,"natural",t[5]),x(n,"pressed",t[0])},m(e,r){p(e,n,r),o||(a=[b(n,"mousedown",q(t[2])),b(n,"mouseup",q(t[3])),b(n,"mouseenter",t[7]),b(n,"mouseleave",t[8]),b(n,"touchstart",q(t[2])),b(n,"touchend",q(t[3]))],o=!0)},p(e,[t]){2&t&&S(n,"--width",e[1]-.47*e[1]*!e[5]+"px"),16&t&&S(n,"transform","translate("+e[4]+"px)"),1&t&&x(n,"pressed",e[0])},i:e,o:e,d(e){e&&m(n),o=!1,r(a)}}}function z(e,t,n){let{noteNum:r}=t,{keyWidth:o=56}=t,{pressed:a=!1}=t;const i=I();let u=![1,3,6,8,10].includes(r%12),s=0;function c(e){a||(i("noteon",r),n(0,a=!0))}function l(e){a&&(i("noteoff",r),n(0,a=!1))}u||([1,6].includes(r%12)?s=-o/12:[3,10].includes(r%12)&&(s=o/12));return e.$$set=e=>{"noteNum"in e&&n(6,r=e.noteNum),"keyWidth"in e&&n(1,o=e.keyWidth),"pressed"in e&&n(0,a=e.pressed)},[a,o,c,l,s,u,r,e=>{e.buttons&&c()},e=>{e.buttons&&l()}]}class ee extends Q{constructor(e){super(),X(this,e,z,H,a,{noteNum:6,keyWidth:1,pressed:0,keyPressed:2,keyReleased:3})}get keyPressed(){return this.$$.ctx[2]}get keyReleased(){return this.$$.ctx[3]}}"undefined"!=typeof globalThis?globalThis:"undefined"!=typeof window?window:"undefined"!=typeof global?global:"undefined"!=typeof self&&self;function te(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var ne,re,oe=(ne=function(e,t){var n;n=function(){return function(e){var t={};function n(r){if(t[r])return t[r].exports;var o=t[r]={exports:{},id:r,loaded:!1};return e[r].call(o.exports,o,o.exports,n),o.loaded=!0,o.exports}return n.m=e,n.c=t,n.p="",n(0)}([function(e,t,n){e.exports=n(1)},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r,o=n(2),a=(r=o)&&r.__esModule?r:{default:r};n(3),n(8),n(9),n(14),window.MIDI=a.default,t.default=a.default,e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default={},e.exports=t.default},function(e,t,n){var r,o="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},a=n(4),i=n(2),u=(r=i)&&r.__esModule?r:{default:r};u.default.Soundfont={},u.default.DEBUG=!0,u.default.USE_XHR=!0,u.default.soundfontUrl="./soundfont/",u.default.loadPlugin=function(e){"function"==typeof e&&(e={onsuccess:e}),u.default.soundfontUrl=e.soundfontUrl||u.default.soundfontUrl,(0,a.audioDetect)((function(t){var n=window.location.hash,r="";if(t[e.api]?r=e.api:t[n.substr(1)]?r=n.substr(1):t.webmidi?r="webmidi":window.AudioContext?r="webaudio":window.Audio&&(r="audiotag"),s[r]){var o=void 0;o=e.targetFormat?e.targetFormat:t["audio/ogg"]?"ogg":"mp3",u.default.__api=r,u.default.__audioFormat=o,u.default.supports=t,u.default.loadResource(e)}}))},u.default.loadResource=function(e){var t=e.instruments||e.instrument||"acoustic_grand_piano";"object"!==(void 0===t?"undefined":o(t))&&(t=t||0===t?[t]:[]);for(var n=0;n<t.length;n++){var r=t[n];r===+r&&u.default.GM.byId[r]&&(t[n]=u.default.GM.byId[r].id)}e.format=u.default.__audioFormat,e.instruments=t,s[u.default.__api](e)};var s={webmidi:function(e){u.default.WebMIDI.connect(e)},audiotag:function(e){c(e,"AudioTag")},webaudio:function(e){c(e,"WebAudio")}},c=function(e,t){for(var n=e.format,r=e.instruments,o=e.onprogress,a=e.onerror,i=r.length,s=i,c=function(){--s||(o&&o("load",1),u.default[t].connect(e))},d=0;d<i;d++){var f=r[d];u.default.Soundfont[f]?c():l(r[d],n,(function(e,t){o&&o("load",t/i+(i-s)/i,f)}),(function(){c()}),a)}},l=function(e,t,n,r,o){var i=u.default.soundfontUrl+e+"-"+t+".js";u.default.USE_XHR?(0,a.request)({url:i,format:"text",onerror:o,onprogress:n,onsuccess:function(e,t){var n=document.createElement("script");n.language="javascript",n.type="text/javascript",n.text=t,document.body.appendChild(n),r()}}):a.loadScript.add({url:i,verify:'root.Soundfont["'+e+'"]',onerror:o,onsuccess:function(){r()}})};u.default.setDefaultPlugin=function(e){for(var t in e)u.default[t]=e[t]}},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(5);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}));var o=n(6);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}));var a=n(7);Object.keys(a).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return a[e]}})}))},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n={},r=0,o=function(e){r++;var t=document.body,o=new window.Audio,a=e.split(";")[0];o.id="audio",o.setAttribute("preload","auto"),o.setAttribute("audiobuffer",!0),o.addEventListener("error",(function(){t.removeChild(o),n[a]=!1,r--}),!1),o.addEventListener("canplaythrough",(function(){t.removeChild(o),n[a]=!0,r--}),!1),o.src="data:"+e,t.appendChild(o)};t.audioDetect=function(e){if(navigator.requestMIDIAccess)if(Function.prototype.toString.call(navigator.requestMIDIAccess).indexOf("[native code]"))n.webmidi=!0;else for(var t=0;navigator.plugins.length>t;t++)navigator.plugins[t].name.indexOf("Jazz-Plugin")>=0&&(n.webmidi=!0);if(void 0===window.Audio)return e({});n.audiotag=!0,(window.AudioContext||window.webkitAudioContext)&&(n.webaudio=!0);var a=new window.Audio;if(void 0===a.canPlayType)return e(n);var i=a.canPlayType('audio/ogg; codecs="vorbis"');i="probably"===i||"maybe"===i;var u=a.canPlayType("audio/mpeg");if(u="probably"===u||"maybe"===u,i||u){i&&o("audio/ogg;base64,T2dnUwACAAAAAAAAAADqnjMlAAAAAOyyzPIBHgF2b3JiaXMAAAAAAUAfAABAHwAAQB8AAEAfAACZAU9nZ1MAAAAAAAAAAAAA6p4zJQEAAAANJGeqCj3//////////5ADdm9yYmlzLQAAAFhpcGguT3JnIGxpYlZvcmJpcyBJIDIwMTAxMTAxIChTY2hhdWZlbnVnZ2V0KQAAAAABBXZvcmJpcw9CQ1YBAAABAAxSFCElGVNKYwiVUlIpBR1jUFtHHWPUOUYhZBBTiEkZpXtPKpVYSsgRUlgpRR1TTFNJlVKWKUUdYxRTSCFT1jFloXMUS4ZJCSVsTa50FkvomWOWMUYdY85aSp1j1jFFHWNSUkmhcxg6ZiVkFDpGxehifDA6laJCKL7H3lLpLYWKW4q91xpT6y2EGEtpwQhhc+211dxKasUYY4wxxsXiUyiC0JBVAAABAABABAFCQ1YBAAoAAMJQDEVRgNCQVQBABgCAABRFcRTHcRxHkiTLAkJDVgEAQAAAAgAAKI7hKJIjSZJkWZZlWZameZaouaov+64u667t6roOhIasBACAAAAYRqF1TCqDEEPKQ4QUY9AzoxBDDEzGHGNONKQMMogzxZAyiFssLqgQBKEhKwKAKAAAwBjEGGIMOeekZFIi55iUTkoDnaPUUcoolRRLjBmlEluJMYLOUeooZZRCjKXFjFKJscRUAABAgAMAQICFUGjIigAgCgCAMAYphZRCjCnmFHOIMeUcgwwxxiBkzinoGJNOSuWck85JiRhjzjEHlXNOSuekctBJyaQTAAAQ4AAAEGAhFBqyIgCIEwAwSJKmWZomipamiaJniqrqiaKqWp5nmp5pqqpnmqpqqqrrmqrqypbnmaZnmqrqmaaqiqbquqaquq6nqrZsuqoum65q267s+rZru77uqapsm6or66bqyrrqyrbuurbtS56nqqKquq5nqq6ruq5uq65r25pqyq6purJtuq4tu7Js664s67pmqq5suqotm64s667s2rYqy7ovuq5uq7Ks+6os+75s67ru2rrwi65r66os674qy74x27bwy7ouHJMnqqqnqq7rmarrqq5r26rr2rqmmq5suq4tm6or26os67Yry7aumaosm64r26bryrIqy77vyrJui67r66Ys67oqy8Lu6roxzLat+6Lr6roqy7qvyrKuu7ru+7JuC7umqrpuyrKvm7Ks+7auC8us27oxuq7vq7It/KosC7+u+8Iy6z5jdF1fV21ZGFbZ9n3d95Vj1nVhWW1b+V1bZ7y+bgy7bvzKrQvLstq2scy6rSyvrxvDLux8W/iVmqratum6um7Ksq/Lui60dd1XRtf1fdW2fV+VZd+3hV9pG8OwjK6r+6os68Jry8ov67qw7MIvLKttK7+r68ow27qw3L6wLL/uC8uq277v6rrStXVluX2fsSu38QsAABhwAAAIMKEMFBqyIgCIEwBAEHIOKQahYgpCCKGkEEIqFWNSMuakZM5JKaWUFEpJrWJMSuaclMwxKaGUlkopqYRSWiqlxBRKaS2l1mJKqcVQSmulpNZKSa2llGJMrcUYMSYlc05K5pyUklJrJZXWMucoZQ5K6iCklEoqraTUYuacpA46Kx2E1EoqMZWUYgupxFZKaq2kFGMrMdXUWo4hpRhLSrGVlFptMdXWWqs1YkxK5pyUzDkqJaXWSiqtZc5J6iC01DkoqaTUYiopxco5SR2ElDLIqJSUWiupxBJSia20FGMpqcXUYq4pxRZDSS2WlFosqcTWYoy1tVRTJ6XFklKMJZUYW6y5ttZqDKXEVkqLsaSUW2sx1xZjjqGkFksrsZWUWmy15dhayzW1VGNKrdYWY40x5ZRrrT2n1mJNMdXaWqy51ZZbzLXnTkprpZQWS0oxttZijTHmHEppraQUWykpxtZara3FXEMpsZXSWiypxNhirLXFVmNqrcYWW62ltVprrb3GVlsurdXcYqw9tZRrrLXmWFNtBQAADDgAAASYUAYKDVkJAEQBAADGMMYYhEYpx5yT0ijlnHNSKucghJBS5hyEEFLKnINQSkuZcxBKSSmUklJqrYVSUmqttQIAAAocAAACbNCUWByg0JCVAEAqAIDBcTRNFFXVdX1fsSxRVFXXlW3jVyxNFFVVdm1b+DVRVFXXtW3bFn5NFFVVdmXZtoWiqrqybduybgvDqKqua9uybeuorqvbuq3bui9UXVmWbVu3dR3XtnXd9nVd+Bmzbeu2buu+8CMMR9/4IeTj+3RCCAAAT3AAACqwYXWEk6KxwEJDVgIAGQAAgDFKGYUYM0gxphhjTDHGmAAAgAEHAIAAE8pAoSErAoAoAADAOeecc84555xzzjnnnHPOOeecc44xxhhjjDHGGGOMMcYYY4wxxhhjjDHGGGOMMcYYY0wAwE6EA8BOhIVQaMhKACAcAABACCEpKaWUUkoRU85BSSmllFKqFIOMSkoppZRSpBR1lFJKKaWUIqWgpJJSSimllElJKaWUUkoppYw6SimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaWUUkoppZRSSimllFJKKaVUSimllFJKKaWUUkoppRQAYPLgAACVYOMMK0lnhaPBhYasBAByAwAAhRiDEEJpraRUUkolVc5BKCWUlEpKKZWUUqqYgxBKKqmlklJKKbXSQSihlFBKKSWUUkooJYQQSgmhlFRCK6mEUkoHoYQSQimhhFRKKSWUzkEoIYUOQkmllNRCSB10VFIpIZVSSiklpZQ6CKGUklJLLZVSWkqpdBJSKamV1FJqqbWSUgmhpFZKSSWl0lpJJbUSSkklpZRSSymFVFJJJYSSUioltZZaSqm11lJIqZWUUkqppdRSSiWlkEpKqZSSUmollZRSaiGVlEpJKaTUSimlpFRCSamlUlpKLbWUSkmptFRSSaWUlEpJKaVSSksppRJKSqmllFpJKYWSUkoplZJSSyW1VEoKJaWUUkmptJRSSymVklIBAEAHDgAAAUZUWoidZlx5BI4oZJiAAgAAQABAgAkgMEBQMApBgDACAQAAAADAAAAfAABHARAR0ZzBAUKCwgJDg8MDAAAAAAAAAAAAAACAT2dnUwAEAAAAAAAAAADqnjMlAgAAADzQPmcBAQA="),u&&o("audio/mpeg;base64,/+MYxAAAAANIAUAAAASEEB/jwOFM/0MM/90b/+RhST//w4NFwOjf///PZu////9lns5GFDv//l9GlUIEEIAAAgIg8Ir/JGq3/+MYxDsLIj5QMYcoAP0dv9HIjUcH//yYSg+CIbkGP//8w0bLVjUP///3Z0x5QCAv/yLjwtGKTEFNRTMuOTeqqqqqqqqqqqqq/+MYxEkNmdJkUYc4AKqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqqq");var s=(new Date).getTime(),c=window.setInterval((function(){var t=(new Date).getTime();r&&!(t-s>5e3)||(window.clearInterval(c),e(n))}),1)}else e(n)}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},r=function(e,t){try{for(var n=(e=e.split('"').join("").split("'").join("").split("]").join("").split("[").join(".")).split("."),r=n.length,o=t||window,a=0;a<r;a++){var i=n[a];if(null==o[i])return!1;o=o[i]}return!0}catch(e){return!1}},o=function(){return this.loaded={},this.loading={},this};o.prototype.add=function(e){var t=this;"string"==typeof e&&(e={url:e});var o=e.urls;void 0===o&&(o=[{url:e.url,verify:e.verify}]);var a=document.getElementsByTagName("head")[0],i=function(e,n){t.loaded[e.url]||n&&!1===r(n)||(t.loaded[e.url]=!0,t.loading[e.url]&&t.loading[e.url](),delete t.loading[e.url],e.onsuccess&&e.onsuccess(),void 0!==p&&p())},u=!1,s=[],c=function(r){if("string"==typeof r&&(r={url:r,verify:e.verify}),/([\w\d.\[\]'"])$/.test(r.verify)){var o=r.test=r.verify;if("object"===(void 0===o?"undefined":n(o)))for(var c=0;c<o.length;c++)s.push(o[c]);else s.push(o)}if(!t.loaded[r.url]){var d=document.createElement("script");d.onreadystatechange=function(){"loaded"!==this.readyState&&"complete"!==this.readyState||i(r)},d.onload=function(){i(r)},d.onerror=function(){if(u=!0,delete t.loading[r.url],"object"===n(r.test))for(var e in r.test)l(r.test[e]);else l(r.test)},d.setAttribute("type","text/javascript"),d.setAttribute("src",r.url),a.appendChild(d),t.loading[r.url]=function(){}}},l=function(e){for(var t=[],n=0;n<s.length;n++)s[n]!==e&&t.push(s[n]);s=t},d=function t(n){if(n)i(n,n.test);else for(var a=0;a<o.length;a++)i(o[a],o[a].test);for(var c=!0,l=0;l<s.length;l++)!1===r(s[l])&&(c=!1);!e.strictOrder&&c?u?e.error&&e.error():e.onsuccess&&e.onsuccess():setTimeout((function(){t(n)}),10)};if(e.strictOrder){var f=-1,p=function n(){if(f++,o[f]){var r=o[f],a=r.url;t.loading[a]?t.loading[a]=function(){r.onsuccess&&r.onsuccess(),n()}:t.loaded[a]?n():(c(r),d(r))}else u?e.error&&e.error():e.onsuccess&&e.onsuccess()};p()}else for(var m=0;m<o.length;m++)c(o[m]),d(o[m])},t.loadScript=new o},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.request=function(e,t,n,r){"string"==typeof e&&(e={url:e});var o=e.data,a=e.url,i=e.method||(e.data?"POST":"GET"),u=e.format,s=e.headers,c=e.responseType,l=e.withCredentials||!1,d=new window.XMLHttpRequest;if(t=t||e.onsuccess,n=n||e.onerror,r=r||e.onprogress,d.open(i,a,!0),s)for(var f in s)d.setRequestHeader(f,s[f]);else o&&d.setRequestHeader("Content-type","application/x-www-form-urlencoded");return"binary"===u&&d.overrideMimeType&&d.overrideMimeType("text/plain; charset=x-user-defined"),c&&(d.responseType=c),l&&(d.withCredentials="true"),n&&"onerror"in d&&(d.onerror=n),r&&d.upload&&"onprogress"in d.upload&&(o?d.upload.onprogress=function(e){r.call(d,e,e.loaded/e.total)}:d.addEventListener("progress",(function(e){var t=0;if(e.lengthComputable)t=e.total;else if(d.totalBytes)t=d.totalBytes;else{var n=parseInt(d.getResponseHeader("Content-Length-Raw"));if(!isFinite(n))return;d.totalBytes=t=n}r.call(d,e,e.loaded/t)}))),d.onreadystatechange=function(e){if(4===d.readyState)if(200===d.status||304===d.status||308===d.status){if(t){var r;if("xml"===u)r=e.target.responseXML;else if("text"===u)r=e.target.responseText;else if("json"===u)try{r=JSON.parse(e.target.response)}catch(t){n&&n.call(d,e)}t.call(d,e,r)}}else n&&n.call(d,e)},d.send(o),d}},function(e,t,n){var r,o=n(2),a=(r=o)&&r.__esModule?r:{default:r};a.default.GM=function(e){var t=function(e){return e.replace(/[^a-z0-9 ]/gi,"").replace(/[ ]/g,"_").toLowerCase()},n={byName:{},byId:{},byCategory:{}};for(var r in e)for(var o=e[r],a=0,i=o.length;a<i;a++){var u=o[a];if(u){var s=parseInt(u.substr(0,u.indexOf(" ")),10);u=u.replace(s+" ",""),n.byId[--s]=n.byName[t(u)]=n.byCategory[t(r)]={id:t(u),instrument:u,number:s,category:r}}}return n}({Piano:["1 Acoustic Grand Piano","2 Bright Acoustic Piano","3 Electric Grand Piano","4 Honky-tonk Piano","5 Electric Piano 1","6 Electric Piano 2","7 Harpsichord","8 Clavinet"],"Chromatic Percussion":["9 Celesta","10 Glockenspiel","11 Music Box","12 Vibraphone","13 Marimba","14 Xylophone","15 Tubular Bells","16 Dulcimer"],Organ:["17 Drawbar Organ","18 Percussive Organ","19 Rock Organ","20 Church Organ","21 Reed Organ","22 Accordion","23 Harmonica","24 Tango Accordion"],Guitar:["25 Acoustic Guitar (nylon)","26 Acoustic Guitar (steel)","27 Electric Guitar (jazz)","28 Electric Guitar (clean)","29 Electric Guitar (muted)","30 Overdriven Guitar","31 Distortion Guitar","32 Guitar Harmonics"],Bass:["33 Acoustic Bass","34 Electric Bass (finger)","35 Electric Bass (pick)","36 Fretless Bass","37 Slap Bass 1","38 Slap Bass 2","39 Synth Bass 1","40 Synth Bass 2"],Strings:["41 Violin","42 Viola","43 Cello","44 Contrabass","45 Tremolo Strings","46 Pizzicato Strings","47 Orchestral Harp","48 Timpani"],Ensemble:["49 String Ensemble 1","50 String Ensemble 2","51 Synth Strings 1","52 Synth Strings 2","53 Choir Aahs","54 Voice Oohs","55 Synth Choir","56 Orchestra Hit"],Brass:["57 Trumpet","58 Trombone","59 Tuba","60 Muted Trumpet","61 French Horn","62 Brass Section","63 Synth Brass 1","64 Synth Brass 2"],Reed:["65 Soprano Sax","66 Alto Sax","67 Tenor Sax","68 Baritone Sax","69 Oboe","70 English Horn","71 Bassoon","72 Clarinet"],Pipe:["73 Piccolo","74 Flute","75 Recorder","76 Pan Flute","77 Blown Bottle","78 Shakuhachi","79 Whistle","80 Ocarina"],"Synth Lead":["81 Lead 1 (square)","82 Lead 2 (sawtooth)","83 Lead 3 (calliope)","84 Lead 4 (chiff)","85 Lead 5 (charang)","86 Lead 6 (voice)","87 Lead 7 (fifths)","88 Lead 8 (bass + lead)"],"Synth Pad":["89 Pad 1 (new age)","90 Pad 2 (warm)","91 Pad 3 (polysynth)","92 Pad 4 (choir)","93 Pad 5 (bowed)","94 Pad 6 (metallic)","95 Pad 7 (halo)","96 Pad 8 (sweep)"],"Synth Effects":["97 FX 1 (rain)","98 FX 2 (soundtrack)","99 FX 3 (crystal)","100 FX 4 (atmosphere)","101 FX 5 (brightness)","102 FX 6 (goblins)","103 FX 7 (echoes)","104 FX 8 (sci-fi)"],Ethnic:["105 Sitar","106 Banjo","107 Shamisen","108 Koto","109 Kalimba","110 Bagpipe","111 Fiddle","112 Shanai"],Percussive:["113 Tinkle Bell","114 Agogo","115 Steel Drums","116 Woodblock","117 Taiko Drum","118 Melodic Tom","119 Synth Drum"],"Sound effects":["120 Reverse Cymbal","121 Guitar Fret Noise","122 Breath Noise","123 Seashore","124 Bird Tweet","125 Telephone Ring","126 Helicopter","127 Applause","128 Gunshot"]}),a.default.getInstrument=function(e){var t=a.default.channels[e];return t&&t.instrument},a.default.setInstrument=function(e,t,n){var r=a.default.channels[e];if(n)return setTimeout((function(){r.instrument=t}),n);r.instrument=t},a.default.getMono=function(e){var t=a.default.channels[e];return t&&t.mono},a.default.setMono=function(e,t,n){var r=a.default.channels[e];if(n)return setTimeout((function(){r.mono=t}),n);r.mono=t},a.default.getOmni=function(e){var t=a.default.channels[e];return t&&t.omni},a.default.setOmni=function(e,t,n){var r=a.default.channels[e];if(n)return setTimeout((function(){r.omni=t}),n);r.omni=t},a.default.getSolo=function(e){var t=a.default.channels[e];return t&&t.solo},a.default.setSolo=function(e,t,n){var r=a.default.channels[e];if(n)return setTimeout((function(){r.solo=t}),n);r.solo=t},a.default.channels=function(){for(var e={},t=0;t<16;t++)e[t]={instrument:t,pitchBend:0,mute:!1,mono:!1,omni:!1,solo:!1};return e}(),a.default.keyToNote={},a.default.noteToKey={},function(){for(var e=["C","Db","D","Eb","E","F","Gb","G","Ab","A","Bb","B"],t=21;t<=108;t++){var n=e[t%12]+((t-12)/12>>0);a.default.keyToNote[n]=t,a.default.noteToKey[t]=n}}()},function(e,t,n){var r,o=n(10),a=n(2),i=(r=a)&&r.__esModule?r:{default:r};!function(){i.default.Player={};var e=i.default.Player;e.currentTime=0,e.endTime=0,e.restart=0,e.playing=!1,e.timeWarp=1,e.startDelay=0,e.BPM=120,e.start=e.resume=function(t){e.currentTime<-1&&(e.currentTime=-1),f(e.currentTime,null,t)},e.pause=function(){var t=e.restart;p(),e.restart=t},e.stop=function(){p(),e.restart=0,e.currentTime=0},e.addListener=function(e){n=e},e.removeListener=function(){n=void 0},e.clearAnimation=function(){e.animationFrameId&&window.cancelAnimationFrame(e.animationFrameId)},e.setAnimation=function(t){var n=0,r=0,o=0;e.clearAnimation(),window.requestAnimationFrame((function a(){if(e.animationFrameId=window.requestAnimationFrame(a),0!==e.endTime){e.playing?(n=o===e.currentTime?r-Date.now():0,n=0===e.currentTime?0:e.currentTime-n,o!==e.currentTime&&(r=Date.now(),o=e.currentTime)):n=e.currentTime;var i=e.endTime,u=n/1e3,c=u/60,l=60*c+(u-60*c),d=i/1e3;d-l<-1||t({now:l,end:d,events:s})}}))},e.loadMidiFile=function(t,n,r){try{e.replayer=new o.Replayer((0,o.MidiFile)(e.currentData),e.timeWarp,null,e.BPM),e.data=e.replayer.getData(),e.endTime=d(),i.default.loadPlugin({onsuccess:t,onprogress:n,onerror:r})}catch(e){console.error(e),r&&r(e)}},e.loadFile=function(t,n,r,o){if(e.stop(),-1!==t.indexOf("base64,")){var a=window.atob(t.split(",")[1]);e.currentData=a,e.loadMidiFile(n,r,o)}else{var i=new window.XMLHttpRequest;i.open("GET",t),i.overrideMimeType("text/plain; charset=x-user-defined"),i.onreadystatechange=function(){if(4===this.readyState)if(200===this.status){for(var t=this.responseText||"",a=[],i=t.length,u=String.fromCharCode,s=0;s<i;s++)a[s]=u(255&t.charCodeAt(s));var c=a.join("");e.currentData=c,e.loadMidiFile(n,r,o)}else o&&o("Unable to load MIDI file")},i.send()}},e.getFileInstruments=function(){for(var t={},n={},r=0;r<e.data.length;r++){var o=e.data[r][0].event;if("channel"===o.type){var a=o.channel;switch(o.subtype){case"controller":break;case"programChange":n[a]=o.programNumber;break;case"noteOn":var u=n[a];t[i.default.GM.byId[isFinite(u)?u:a].id]=!0}}}var s=[];for(var c in t)s.push(c);return s};var t,n,r,a=[],u=0,s={},c=function(r,o,i,u,c,l,d){return setTimeout((function(){var u={channel:r,note:o,now:i,end:e.endTime,message:c,velocity:l};128===c?delete s[o]:s[o]=u,n&&n(u),e.currentTime=i,a.shift(),(a.length<1e3||e.currentTime===t&&t<e.endTime)&&f(t,!0)}),i-u)},l=function(){return"webaudio"===i.default.api?i.default.WebAudio.getContext():(e.ctx={currentTime:0},e.ctx)},d=function(){for(var t=e.data,n=t.length,r=.5,o=0;o<n;o++)r+=t[o][1];return r},f=function(n,o,s){if(e.replayer){var f;o||(void 0===n&&(n=e.restart),e.playing&&p(),e.playing=!0,e.data=e.replayer.getData(),e.endTime=d());var m=0,h=0,v=e.data,y=l(),g=v.length;t=.5;var A=n-e.currentTime;if("webaudio"!==i.default.api){var b=window.performance&&window.performance.now?window.performance.now():Date.now();r=r||b,y.currentTime=(b-r)/1e3}u=y.currentTime;for(var q=0;q<g&&h<100;q++){var w=v[q];if((t+=w[1])<=n)m=t;else{n=t-m;var S=w[0].event;if("channel"===S.type){var x=S.channel,k=i.default.channels[x],T=y.currentTime+(n+A+e.startDelay)/1e3,E=t-m+e.startDelay;switch(S.subtype){case"controller":i.default.setController(x,S.controllerType,S.value,T);break;case"programChange":i.default.programChange(x,S.programNumber,T);break;case"pitchBend":i.default.pitchBend(x,S.value,T);break;case"noteOn":if(k.mute)break;f=S.noteNumber-(e.MIDIOffset||0),a.push({event:S,time:E,source:i.default.noteOn(x,S.noteNumber,S.velocity,T),interval:c(x,f,t+e.startDelay,m-A,144,S.velocity)}),h++;break;case"noteOff":if(k.mute)break;f=S.noteNumber-(e.MIDIOffset||0),a.push({event:S,time:E,source:i.default.noteOff(x,S.noteNumber,T),interval:c(x,f,t,m-A,128,0)})}}}}s&&s(a)}},p=function(){var t=l();for(e.playing=!1,e.restart+=1e3*(t.currentTime-u);a.length;){var r=a.pop();window.clearInterval(r.interval),r.source&&("number"==typeof r.source?window.clearTimeout(r.source):r.source.disconnect(0))}for(var o in s){var i=s[o];144===s[o].message&&n&&n({channel:i.channel,note:i.note,now:i.now,end:i.end,message:128,velocity:i.velocity})}s={}}}()},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0});var r=n(11);Object.keys(r).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return r[e]}})}));var o=n(13);Object.keys(o).forEach((function(e){"default"!==e&&"__esModule"!==e&&Object.defineProperty(t,e,{enumerable:!0,get:function(){return o[e]}})}))},function(e,t,n){Object.defineProperty(t,"__esModule",{value:!0}),t.MidiFile=function(e){var t;function n(e){var t=e.read(4),n=e.readInt32();return{id:t,length:n,data:e.read(n)}}function r(e){var n={};n.deltaTime=e.readVarInt();var r=e.readInt8();if(240==(240&r)){if(255!==r){if(240===r){n.type="sysEx";var o=e.readVarInt();return n.data=e.read(o),n}if(247===r){n.type="dividedSysEx";var a=e.readVarInt();return n.data=e.read(a),n}throw new Error("Unrecognised MIDI event type byte: "+r)}n.type="meta";var i=e.readInt8(),u=e.readVarInt();switch(i){case 0:if(n.subtype="sequenceNumber",2!==u)throw new Error("Expected length for sequenceNumber event is 2, got "+u);return n.number=e.readInt16(),n;case 1:return n.subtype="text",n.text=e.read(u),n;case 2:return n.subtype="copyrightNotice",n.text=e.read(u),n;case 3:return n.subtype="trackName",n.text=e.read(u),n;case 4:return n.subtype="instrumentName",n.text=e.read(u),n;case 5:return n.subtype="lyrics",n.text=e.read(u),n;case 6:return n.subtype="marker",n.text=e.read(u),n;case 7:return n.subtype="cuePoint",n.text=e.read(u),n;case 32:if(n.subtype="midiChannelPrefix",1!==u)throw new Error("Expected length for midiChannelPrefix event is 1, got "+u);return n.channel=e.readInt8(),n;case 47:if(n.subtype="endOfTrack",0!==u)throw new Error("Expected length for endOfTrack event is 0, got "+u);return n;case 81:if(n.subtype="setTempo",3!==u)throw new Error("Expected length for setTempo event is 3, got "+u);return n.microsecondsPerBeat=(e.readInt8()<<16)+(e.readInt8()<<8)+e.readInt8(),n;case 84:if(n.subtype="smpteOffset",5!==u)throw new Error("Expected length for smpteOffset event is 5, got "+u);var s=e.readInt8();return n.frameRate={0:24,32:25,64:29,96:30}[96&s],n.hour=31&s,n.min=e.readInt8(),n.sec=e.readInt8(),n.frame=e.readInt8(),n.subframe=e.readInt8(),n;case 88:if(n.subtype="timeSignature",4!==u)throw new Error("Expected length for timeSignature event is 4, got "+u);return n.numerator=e.readInt8(),n.denominator=Math.pow(2,e.readInt8()),n.metronome=e.readInt8(),n.thirtyseconds=e.readInt8(),n;case 89:if(n.subtype="keySignature",2!==u)throw new Error("Expected length for keySignature event is 2, got "+u);return n.key=e.readInt8(!0),n.scale=e.readInt8(),n;case 127:return n.subtype="sequencerSpecific",n.data=e.read(u),n;default:return n.subtype="unknown",n.data=e.read(u),n}}else{var c;0==(128&r)?(c=r,r=t):(c=e.readInt8(),t=r);var l=r>>4;switch(n.channel=15&r,n.type="channel",l){case 8:return n.subtype="noteOff",n.noteNumber=c,n.velocity=e.readInt8(),n;case 9:return n.noteNumber=c,n.velocity=e.readInt8(),0===n.velocity?n.subtype="noteOff":n.subtype="noteOn",n;case 10:return n.subtype="noteAftertouch",n.noteNumber=c,n.amount=e.readInt8(),n;case 11:return n.subtype="controller",n.controllerType=c,n.value=e.readInt8(),n;case 12:return n.subtype="programChange",n.programNumber=c,n;case 13:return n.subtype="channelAftertouch",n.amount=c,n;case 14:return n.subtype="pitchBend",n.value=c+(e.readInt8()<<7),n;default:throw new Error("Unrecognised MIDI event type: "+l)}}}var o=(0,a.default)(e),i=n(o);if("MThd"!==i.id||6!==i.length)throw new Error("Bad .mid file - header not found");var u=(0,a.default)(i.data),s=u.readInt16(),c=u.readInt16(),l=u.readInt16();if(32768&l)throw new Error("Expressing time division in SMTPE frames is not supported yet");for(var d={formatType:s,trackCount:c,ticksPerBeat:l},f=[],p=0;p<d.trackCount;p++){f[p]=[];var m=n(o);if("MTrk"!==m.id)throw new Error("Unexpected chunk - expected MTrk, got "+m.id);for(var h=(0,a.default)(m.data);!h.eof();){var v=r(h);f[p].push(v)}}return{header:d,tracks:f}};var r,o=n(12),a=(r=o)&&r.__esModule?r:{default:r}},function(e,t){Object.defineProperty(t,"__esModule",{value:!0}),t.default=function(e){var t=0;function n(n){var r=e.charCodeAt(t);return n&&r>127&&(r-=256),t+=1,r}return{eof:function(){return t>=e.length},read:function(n){var r=e.substr(t,n);return t+=n,r},readInt32:function(){var n=(e.charCodeAt(t)<<24)+(e.charCodeAt(t+1)<<16)+(e.charCodeAt(t+2)<<8)+e.charCodeAt(t+3);return t+=4,n},readInt16:function(){var n=(e.charCodeAt(t)<<8)+e.charCodeAt(t+1);return t+=2,n},readInt8:n,readVarInt:function(){for(var e=0;;){var t=n();if(!(128&t))return e+t;e+=127&t,e<<=7}}}},e.exports=t.default},function(e,t){Object.defineProperty(t,"__esModule",{value:!0});var n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e};t.Replayer=function(e,t,n,o){for(var a,i=[],u=o||120,s=!!o,c=e.header.ticksPerBeat,l=0;l<e.tracks.length;l++)i[l]={nextEventIndex:0,ticksToNextEvent:e.tracks[l].length?e.tracks[l][0].deltaTime:null};function d(){for(var t=null,n=null,r=null,o=0;o<i.length;o++)null!=i[o].ticksToNextEvent&&(null==t||i[o].ticksToNextEvent<t)&&(t=i[o].ticksToNextEvent,n=o,r=i[o].nextEventIndex);if(null!=n){var a=e.tracks[n][r];e.tracks[n][r+1]?i[n].ticksToNextEvent+=e.tracks[n][r+1].deltaTime:i[n].ticksToNextEvent=null,i[n].nextEventIndex+=1;for(var u=0;u<i.length;u++)null!=i[u].ticksToNextEvent&&(i[u].ticksToNextEvent-=t);return{ticksToEvent:t,event:a,track:n}}return null}var f=[];return function(){function e(){s||"meta"!==a.event.type||"setTempo"!==a.event.subtype||(u=6e7/a.event.microsecondsPerBeat);var e=0;a.ticksToEvent>0&&(e=a.ticksToEvent/c/(u/60));var n=1e3*e*t||0;f.push([a,n]),a=d()}if(a=d())for(;a;)e()}(),{getData:function(){return r(f)}}};var r=function e(t){if("object"!==(void 0===t?"undefined":n(t)))return t;if(null===t)return t;var r="number"==typeof t.length?[]:{};for(var o in t)r[o]=e(t[o]);return r}},function(e,t,n){n(15),n(16),n(17)},function(e,t,n){var r,o=n(2),a=(r=o)&&r.__esModule?r:{default:r};window.Audio&&function(){for(var e=a.default.AudioTag={api:"audiotag"},t={},n=127,r=-1,o=[],i=[],u={},s=0;s<12;s++)o[s]=new window.Audio;var c=function(e,t){if(a.default.channels[e]){var s=a.default.channels[e].instrument,c=a.default.GM.byId[s].id;if(t=u[t]){var l=c+""+t.id,d=(r+1)%o.length,f=o[d];if(i[d]=l,!a.default.Soundfont[c])return void(a.default.DEBUG&&console.log("404",c));f.src=a.default.Soundfont[c][t.id],f.volume=n/127,f.play(),r=d}}},l=function(e,t){if(a.default.channels[e]){var n=a.default.channels[e].instrument,s=a.default.GM.byId[n].id;if(t=u[t])for(var c=s+""+t.id,l=0,d=o.length;l<d;l++){var f=(l+r+1)%d,p=i[f];if(p&&p===c)return o[f].pause(),void(i[f]=null)}}};e.audioBuffers=o,e.send=function(e,t){},e.setController=function(e,t,n,r){},e.setVolume=function(e,t){n=t},e.programChange=function(e,t){a.default.channels[e].instrument=t},e.pitchBend=function(e,t,n){},e.noteOn=function(e,n,r,o){var a=t[n];if(u[a])return o?setTimeout((function(){c(e,a)}),1e3*o):void c(e,a)},e.noteOff=function(e,t,n){},e.chordOn=function(e,n,r,o){for(var a=0;a<n.length;a++){var i=n[a],s=t[i];if(u[s]){if(o)return setTimeout((function(){c(e,s)}),1e3*o);c(e,s)}}},e.chordOff=function(e,n,r){for(var o=0;o<n.length;o++){var a=n[o],i=t[a];if(u[i]){if(r)return setTimeout((function(){l(e,i)}),1e3*r);l(e,i)}}},e.stopAllNotes=function(){for(var e=0,t=o.length;e<t;e++)o[e].pause()},e.connect=function(n){for(var r in a.default.setDefaultPlugin(e),a.default.keyToNote)t[a.default.keyToNote[r]]=r,u[r]={id:r};n.onsuccess&&n.onsuccess()}}()},function(e,t,n){var r,o=n(2),a=(r=o)&&r.__esModule?r:{default:r};window.AudioContext&&function(){var e,t=a.default.WebAudio={api:"webaudio"},n={},r={},o=127,i={};t.audioBuffers=i,t.send=function(e,t){},t.setController=function(e,t,n,r){},t.setVolume=function(e,t,n){n?setTimeout((function(){o=t}),1e3*n):o=t},t.programChange=function(e,t,n){a.default.channels[e].instrument=t},t.pitchBend=function(e,t,n){a.default.channels[e].pitchBend=t},t.noteOn=function(t,u,s,c){c=c||0;var l=a.default.channels[t].instrument,d=i[l+""+u];if(d){var f;if(c<e.currentTime&&(c+=e.currentTime),(f=e.createBufferSource()).buffer=d,r){var p=f;for(var m in r)p.connect(r[m].input),p=r[m]}var h=s/127*(o/127)*2-1;return f.connect(e.destination),f.playbackRate.value=1,f.gainNode=e.createGain(),f.gainNode.connect(e.destination),f.gainNode.gain.value=Math.min(1,Math.max(-1,h)),f.connect(f.gainNode),f.start(c||0),n[t+""+u]=f,f}},t.noteOff=function(t,r,o){o=o||0;var u=a.default.channels[t].instrument;if(i[u+""+r]){o<e.currentTime&&(o+=e.currentTime);var s=n[t+""+r];if(s){if(s.gainNode){var c=s.gainNode.gain;c.linearRampToValueAtTime(c.value,o),c.linearRampToValueAtTime(-1,o+.3)}return s.noteOff?s.noteOff(o+.5):s.stop(o+.5),delete n[t+""+r],s}}},t.chordOn=function(e,n,r,o){for(var a,i={},u=0,s=n.length;u<s;u++)i[a=n[u]]=t.noteOn(e,a,r,o);return i},t.chordOff=function(e,n,r){for(var o,a={},i=0,u=n.length;i<u;i++)a[o=n[i]]=t.noteOff(e,o,r);return a},t.stopAllNotes=function(){for(var t in n){var r=0;r<e.currentTime&&(r+=e.currentTime);var o=n[t];o.gain.linearRampToValueAtTime(1,r),o.gain.linearRampToValueAtTime(0,r+.3),o.noteOff?o.noteOff(r+.3):o.stop(r+.3),delete n[t]}},t.setEffects=function(t){if(!e.tunajs)return console.log("Effects module not installed.");for(var n=0;n<t.length;n++){var o=t[n],a=new e.tunajs[o.type](o);a.connect(e.destination),r[o.type]=a}},t.connect=function(n){a.default.setDefaultPlugin(t),t.setContext(e||new(window.AudioContext||window.webkitAudioContext),n.onsuccess)},t.getContext=function(){return e},t.setContext=function(t,n,r,o){e=t,void 0===window.Tuna||e.tunajs||(e.tunajs=new window.Tuna(e));var u=[],s=a.default.keyToNote;for(var c in s)u.push(c);var l=function(e){for(var t in f)if(f[t])return;n&&(n(),n=null)},d=function(t,n,r,o){var u=t[o];u&&(f[n]++,function(t,n,r){if(0===t.indexOf("data:audio")){var o=function(e){for(var t=window.atob(e),n=t.length,r=new Uint8Array(n),o=0;o<n;o++)r[o]=t.charCodeAt(o);return r.buffer}(t.split(",")[1]);e.decodeAudioData(o,n,r)}else{var a=new window.XMLHttpRequest;a.open("GET",t,!0),a.responseType="arraybuffer",a.onload=function(){e.decodeAudioData(a.response,n,r)},a.send()}}(u,(function(e){e.id=o;var r=a.default.keyToNote[o];i[n+""+r]=e,0==--f[n]&&(t.isLoaded=!0,l())}),(function(e){console.error(e)})))},f={};for(var p in a.default.Soundfont){var m=a.default.Soundfont[p];if(!m.isLoaded){var h=a.default.GM.byName[p].number;f[h]=0;for(var v=0;v<u.length;v++)d(m,h,0,u[v])}}setTimeout(l,1)}}()},function(e,t,n){var r,o=n(2),a=(r=o)&&r.__esModule?r:{default:r};!function(){var e=null,t=a.default.WebMIDI={api:"webmidi"};t.send=function(t,n){e.send(t,1e3*n)},t.setController=function(t,n,r,o){e.send([t,n,r],1e3*o)},t.setVolume=function(t,n,r){e.send([176+t,7,n],1e3*r)},t.programChange=function(t,n,r){e.send([192+t,n],1e3*r)},t.pitchBend=function(t,n,r){e.send([224+t,n],1e3*r)},t.noteOn=function(t,n,r,o){e.send([144+t,n,r],1e3*o)},t.noteOff=function(t,n,r){e.send([128+t,n,0],1e3*r)},t.chordOn=function(t,n,r,o){for(var a=0;a<n.length;a++){var i=n[a];e.send([144+t,i,r],1e3*o)}},t.chordOff=function(t,n,r){for(var o=0;o<n.length;o++){var a=n[o];e.send([128+t,a,0],1e3*r)}},t.stopAllNotes=function(){e.cancel();for(var t=0;t<16;t++)e.send([176+t,123,0])},t.connect=function(n){a.default.setDefaultPlugin(t);var r=function(e){if(window.AudioContext)n.api="webaudio";else{if(!window.Audio)return e;n.api="audiotag"}a.default.loadPlugin(n)};navigator.requestMIDIAccess().then((function(t){var o=t.outputs;void 0===(e="function"==typeof o?o()[0]:o[0])?r():n.onsuccess&&n.onsuccess()}),r)}}()}])},e.exports=n()},ne(re={exports:{}},re.exports),re.exports),ae=te(oe);function ie(e,t,n){const r=e.slice();return r[17]=t[n],r}function ue(e,t,n){const r=e.slice();return r[20]=t[n],r[21]=t,r[22]=n,r}function se(e){let t,n,r=e[20];const o=()=>e[13](t,r),a=()=>e[13](null,r);let i={noteNum:e[20],keyWidth:e[6],pressed:e[0].includes(e[20])};return t=new ee({props:i}),o(),t.$on("noteon",e[14]),t.$on("noteoff",e[15]),{c(){Z(t.$$.fragment)},m(e,r){G(t,e,r),n=!0},p(e,n){r!==e[20]&&(a(),r=e[20],o());const i={};8&n&&(i.noteNum=e[20]),64&n&&(i.keyWidth=e[6]),9&n&&(i.pressed=e[0].includes(e[20])),t.$set(i)},i(e){n||(J(t.$$.fragment,e),n=!0)},o(e){V(t.$$.fragment,e),n=!1},d(e){a(),Y(t,e)}}}function ce(e){let t,n=e[4],r=[];for(let t=0;t<n.length;t+=1)r[t]=le(ie(e,n,t));return{c(){for(let e=0;e<r.length;e+=1)r[e].c();t=A()},m(e,n){for(let t=0;t<r.length;t+=1)r[t].m(e,n);p(e,t,n)},p(e,o){if(16&o){let a;for(n=e[4],a=0;a<n.length;a+=1){const i=ie(e,n,a);r[a]?r[a].p(i,o):(r[a]=le(i),r[a].c(),r[a].m(t.parentNode,t))}for(;a<r.length;a+=1)r[a].d(1);r.length=n.length}},d(e){h(r,e),e&&m(t)}}}function le(e){let t,n,r=e[17]+"";return{c(){t=v("div"),n=y(r)},m(e,r){p(e,t,r),f(t,n)},p(e,t){16&t&&r!==(r=e[17]+"")&&function(e,t){t=""+t,e.wholeText!==t&&(e.data=t)}(n,r)},d(e){e&&m(t)}}}function de(e){let t,n,r,o,a,i,u;U(e[12]);let s=e[3],c=[];for(let t=0;t<s.length;t+=1)c[t]=se(ue(e,s,t));const l=e=>V(c[e],1,1,(()=>{c[e]=null}));let d=e[1]&&ce(e);return{c(){t=v("div"),n=v("div");for(let e=0;e<c.length;e+=1)c[e].c();r=g(),d&&d.c(),o=A(),w(n,"class","svelte-e1a7d6"),w(t,"class","keyboard svelte-e1a7d6")},m(s,l){p(s,t,l),f(t,n);for(let e=0;e<c.length;e+=1)c[e].m(n,null);p(s,r,l),d&&d.m(s,l),p(s,o,l),a=!0,i||(u=b(window,"resize",e[12]),i=!0)},p(e,[t]){if(1001&t){let r;for(s=e[3],r=0;r<s.length;r+=1){const o=ue(e,s,r);c[r]?(c[r].p(o,t),J(c[r],1)):(c[r]=se(o),c[r].c(),J(c[r],1),c[r].m(n,null))}for(R(),r=s.length;r<c.length;r+=1)l(r);j()}e[1]?d?d.p(e,t):(d=ce(e),d.c(),d.m(o.parentNode,o)):d&&(d.d(1),d=null)},i(e){if(!a){for(let e=0;e<s.length;e+=1)J(c[e]);a=!0}},o(e){c=c.filter(Boolean);for(let e=0;e<c.length;e+=1)V(c[e]);a=!1},d(e){e&&m(t),h(c,e),e&&m(r),d&&d.d(e),e&&m(o),i=!1,u()}}}function fe(e,t,n){let r,{octaves:o=2}=t,{middleC:a=60}=t,{keysPressed:i=[]}=t,{verbose:u}=t;const s=12*o;let c,l=[];function d(e,t=127){n(4,l=[`Note ${e} was pressed!`,...l]),ae.noteOn(0,e,t,0)}function f(e){n(4,l=[`Note ${e} was released!`,...l]),ae.noteOff(0,e,0)}function p(e){var t,n,r;if(u){let t="MIDI message received at timestamp "+e.timeStamp+"["+e.data.length+" bytes]: ";for(let n=0;n<e.data.length;n++)t+="0x"+e.data[n].toString(16)+" ",e.data;console.log(t)}const o=e.data[0],a=e.data[1]%s,i=e.data.length>2?e.data[2]:0;switch(o){case 144:i>0?null===(t=h[a])||void 0===t||t.keyPressed(a):null===(n=h[a])||void 0===n||n.keyReleased(a);break;case 128:null===(r=h[a])||void 0===r||r.keyReleased(a)}}!function(e){E().$$.on_mount.push(e)}((async()=>{ae.loadPlugin({soundfontUrl:"./soundfont/",instrument:"acoustic_grand_piano",onprogress(e,t){console.log(e,t)},onsuccess(){ae.setVolume(0,127)}});try{let e=await navigator.requestMIDIAccess();console.log("MIDI ready!"),u&&function(e){for(const t of e.inputs){const e=t[1];console.log("Input port [type:'"+e.type+"'] id:'"+e.id+"' manufacturer:'"+e.manufacturer+"' name:'"+e.name+"' version:'"+e.version+"'")}for(const t of e.outputs){const e=t[1];console.log("Output port [type:'"+e.type+"'] id:'"+e.id+"' manufacturer:'"+e.manufacturer+"' name:'"+e.name+"' version:'"+e.version+"'")}}(e),e.inputs.forEach((e=>{e.onmidimessage=p}))}catch(e){console.log("Failed to get MIDI access - "+e)}}));let m,h={};return e.$$set=e=>{"octaves"in e&&n(10,o=e.octaves),"middleC"in e&&n(11,a=e.middleC),"keysPressed"in e&&n(0,i=e.keysPressed),"verbose"in e&&n(1,u=e.verbose)},e.$$.update=()=>{3072&e.$$.dirty&&n(3,c=[...Array(12*o+1).keys()].map((e=>e+(a-12*Math.floor(o/2))))),1028&e.$$.dirty&&n(6,r=Math.min((m-36/o)/(8*o),56))},[i,u,m,c,l,h,r,s,d,f,o,a,function(){n(2,m=window.innerWidth)},function(e,t){C[e?"unshift":"push"]((()=>{h[t%s]=e,n(5,h)}))},({detail:e})=>d(e),({detail:e})=>f(e)]}class pe extends Q{constructor(e){super(),X(this,e,fe,de,a,{octaves:10,middleC:11,keysPressed:0,verbose:1})}}const me=e=>({}),he=e=>({});function ve(e){let t,n,o,a,i,s,h,y,A;const q=e[4].header,S=u(q,e,e[3],he),x=e[4].default,k=u(x,e,e[3],null);return{c(){t=v("div"),n=g(),o=v("div"),S&&S.c(),a=g(),k&&k.c(),i=g(),s=v("button"),s.textContent="Close",w(t,"class","modal-background svelte-1v9i8a4"),s.autofocus=!0,w(s,"class","svelte-1v9i8a4"),w(o,"class","modal svelte-1v9i8a4"),w(o,"role","dialog"),w(o,"aria-modal","true")},m(r,u){p(r,t,u),p(r,n,u),p(r,o,u),S&&S.m(o,null),f(o,a),k&&k.m(o,null),f(o,i),f(o,s),e[5](o),h=!0,s.focus(),y||(A=[b(window,"keydown",e[2]),b(t,"click",e[1]),b(s,"click",e[1])],y=!0)},p(e,[t]){S&&S.p&&(!h||8&t)&&l(S,q,e,e[3],h?c(q,e[3],t,me):d(e[3]),he),k&&k.p&&(!h||8&t)&&l(k,x,e,e[3],h?c(x,e[3],t,null):d(e[3]),null)},i(e){h||(J(S,e),J(k,e),h=!0)},o(e){V(S,e),V(k,e),h=!1},d(a){a&&m(t),a&&m(n),a&&m(o),S&&S.d(a),k&&k.d(a),e[5](null),y=!1,r(A)}}}function ye(e,t,n){let{$$slots:r={},$$scope:o}=t;const a=I(),i=()=>a("close");let u;const s="undefined"!=typeof document&&document.activeElement;return s&&function(e){E().$$.on_destroy.push(e)}((()=>{s.focus()})),e.$$set=e=>{"$$scope"in e&&n(3,o=e.$$scope)},[u,i,e=>{if("Escape"!==e.key){if("Tab"===e.key){const t=u.querySelectorAll("*"),n=Array.from(t).filter((e=>e.tabIndex>=0));let r=n.indexOf(document.activeElement);-1===r&&e.shiftKey&&(r=0),r+=n.length+(e.shiftKey?-1:1),r%=n.length,n[r].focus(),e.preventDefault()}}else i()},o,r,function(e){C[e?"unshift":"push"]((()=>{u=e,n(0,u)}))}]}class ge extends Q{constructor(e){super(),X(this,e,ye,ve,a,{})}}const Ae=[];function be(t,n=e){let r;const o=new Set;function i(e){if(a(t,e)&&(t=e,r)){const e=!Ae.length;for(const e of o)e[1](),Ae.push(e,t);if(e){for(let e=0;e<Ae.length;e+=2)Ae[e][0](Ae[e+1]);Ae.length=0}}}return{set:i,update:function(e){i(e(t))},subscribe:function(a,u=e){const s=[a,u];return o.add(s),1===o.size&&(r=n(i)||e),a(t),()=>{o.delete(s),0===o.size&&(r(),r=null)}}}}const qe=be(1),we=be(!1),Se=e=>({}),xe=e=>({});function ke(e){let t,n;return t=new ge({props:{$$slots:{default:[Te]},$$scope:{ctx:e}}}),t.$on("close",e[10]),{c(){Z(t.$$.fragment)},m(e,r){G(t,e,r),n=!0},p(e,n){const r={};2054&n&&(r.$$scope={dirty:n,ctx:e}),t.$set(r)},i(e){n||(J(t.$$.fragment,e),n=!0)},o(e){V(t.$$.fragment,e),n=!1},d(e){Y(t,e)}}}function Te(t){let n,o,a,i,s,h,A,q,S,x,k,T,E,I,M,C,$,_,B,O,U,F,K;const D=t[3].header,W=u(D,t,t[11],xe),N=W||function(t){let n;return{c(){n=v("h1"),n.textContent="Settings"},m(e,t){p(e,n,t)},p:e,d(e){e&&m(n)}}}();return{c(){N&&N.c(),n=g(),o=v("h2"),o.textContent="Octaves",a=g(),i=v("label"),s=v("input"),h=y("\n      One"),A=g(),q=v("label"),S=v("input"),x=y("\n      Two"),k=g(),T=v("label"),E=v("input"),I=y("\n      Three"),M=g(),C=v("h2"),C.textContent="Debug",$=g(),_=v("label"),B=y("Enable logging:\n      "),O=v("input"),w(s,"type","radio"),w(s,"name","octaves"),s.__value=1,s.value=s.__value,t[6][0].push(s),w(S,"type","radio"),w(S,"name","octaves"),S.__value=2,S.value=S.__value,t[6][0].push(S),w(E,"type","radio"),w(E,"name","octaves"),E.__value=3,E.value=E.__value,t[6][0].push(E),w(O,"type","checkbox")},m(e,r){N&&N.m(e,r),p(e,n,r),p(e,o,r),p(e,a,r),p(e,i,r),f(i,s),s.checked=s.__value===t[1],f(i,h),p(e,A,r),p(e,q,r),f(q,S),S.checked=S.__value===t[1],f(q,x),p(e,k,r),p(e,T,r),f(T,E),E.checked=E.__value===t[1],f(T,I),p(e,M,r),p(e,C,r),p(e,$,r),p(e,_,r),f(_,B),f(_,O),O.checked=t[2],U=!0,F||(K=[b(s,"change",t[5]),b(S,"change",t[7]),b(E,"change",t[8]),b(O,"change",t[9])],F=!0)},p(e,t){W&&W.p&&(!U||2048&t)&&l(W,D,e,e[11],U?c(D,e[11],t,Se):d(e[11]),xe),2&t&&(s.checked=s.__value===e[1]),2&t&&(S.checked=S.__value===e[1]),2&t&&(E.checked=E.__value===e[1]),4&t&&(O.checked=e[2])},i(e){U||(J(N,e),U=!0)},o(e){V(N,e),U=!1},d(e){N&&N.d(e),e&&m(n),e&&m(o),e&&m(a),e&&m(i),t[6][0].splice(t[6][0].indexOf(s),1),e&&m(A),e&&m(q),t[6][0].splice(t[6][0].indexOf(S),1),e&&m(k),e&&m(T),t[6][0].splice(t[6][0].indexOf(E),1),e&&m(M),e&&m(C),e&&m($),e&&m(_),F=!1,r(K)}}}function Ee(e){let t,n,r,o,a,i,u=e[0]&&ke(e);return{c(){t=v("button"),t.textContent="⚙️ Settings",n=g(),u&&u.c(),r=A(),w(t,"display","inline-block;")},m(s,c){p(s,t,c),p(s,n,c),u&&u.m(s,c),p(s,r,c),o=!0,a||(i=b(t,"click",e[4]),a=!0)},p(e,[t]){e[0]?u?(u.p(e,t),1&t&&J(u,1)):(u=ke(e),u.c(),J(u,1),u.m(r.parentNode,r)):u&&(R(),V(u,1,1,(()=>{u=null})),j())},i(e){o||(J(u),o=!0)},o(e){V(u),o=!1},d(e){e&&m(t),e&&m(n),u&&u.d(e),e&&m(r),a=!1,i()}}}function Ie(e,t,n){let r,o;i(e,qe,(e=>n(1,r=e))),i(e,we,(e=>n(2,o=e)));let{$$slots:a={},$$scope:u}=t,s=!1;return e.$$set=e=>{"$$scope"in e&&n(11,u=e.$$scope)},[s,r,o,a,()=>n(0,s=!0),function(){r=this.__value,qe.set(r)},[[]],function(){r=this.__value,qe.set(r)},function(){r=this.__value,qe.set(r)},function(){o=this.checked,we.set(o)},()=>n(0,s=!1),u]}class Me extends Q{constructor(e){super(),X(this,e,Ie,Ee,a,{})}}function Ce(e){let t,n;return t=new pe({props:{octaves:e[0],verbose:e[1]}}),{c(){Z(t.$$.fragment)},m(e,r){G(t,e,r),n=!0},p(e,n){const r={};1&n&&(r.octaves=e[0]),2&n&&(r.verbose=e[1]),t.$set(r)},i(e){n||(J(t.$$.fragment,e),n=!0)},o(e){V(t.$$.fragment,e),n=!1},d(e){Y(t,e)}}}function $e(t){let n,r,o,i,u,s,c,l,d=t[0];u=new Me({});let h=Ce(t);return{c(){n=g(),r=v("div"),o=v("h1"),o.innerHTML='<a href="https://github.com/lukemcneil/ear-game">Ear Game</a>',i=g(),Z(u.$$.fragment),s=g(),h.c(),c=A(),document.title="Ear Game",w(r,"class","nav svelte-4cokm4")},m(e,t){p(e,n,t),p(e,r,t),f(r,o),f(r,i),G(u,r,null),p(e,s,t),h.m(e,t),p(e,c,t),l=!0},p(t,[n]){1&n&&a(d,d=t[0])?(R(),V(h,1,1,e),j(),h=Ce(t),h.c(),J(h),h.m(c.parentNode,c)):h.p(t,n)},i(e){l||(J(u.$$.fragment,e),J(h),l=!0)},o(e){V(u.$$.fragment,e),V(h),l=!1},d(e){e&&m(n),e&&m(r),Y(u),e&&m(s),e&&m(c),h.d(e)}}}function _e(e,t,n){let r,o;return i(e,qe,(e=>n(0,r=e))),i(e,we,(e=>n(1,o=e))),[r,o]}return new class extends Q{constructor(e){super(),X(this,e,_e,$e,a,{})}}({target:document.body})}();
//# sourceMappingURL=bundle.js.map
